<!DOCTYPE html>
<html>

<head>
    <style>
        @page {
            size: A4 portrait;
            margin: 1cm;

            @frame footer_frame {
                -pdf-frame-content: footerContent;
                bottom: 0.5cm;
                margin-left: 1cm;
                margin-right: 1cm;
                height: 1cm;
            }
        }

        body {
            font-family: Helvetica, sans-serif;
            font-size: 10pt;
            color: #000;
        }

        .grid-container {
            border-spacing: 8px;
            margin: 0 auto;
        }

        .seat {
            width: 60px;
            height: 60px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            text-align: center;
            vertical-align: middle;
        }

        /* Flex content inside TD for alignment */
        .seat-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }

        .seat-assigned {
            background-color: #eff6ff !important;
            border-color: #bfdbfe !important;
            color: #000000;
            background-color: #eff6ff;
        }

        .seat-empty {
            background-color: #f8fafc !important;
            opacity: 0.6;
            background-color: #f8fafc;
        }

        .student-roll {
            font-size: 0.8rem !important;
            font-weight: bold !important;
            color: #000000 !important;
            display: block;
        }

        .student-class {
            font-size: 0.65rem !important;
            color: #000000 !important;
            display: block;
        }

        .row-label {
            background: none !important;
            color: #94a3b8;
            font-size: 0.8rem;
            border: none;
            padding-right: 10px;
            font-weight: bold;
        }
    </style>
</head>

<body>
    {% if public_view %}
    <div class="web-header">
        <a href="{% url 'public_search' %}" class="btn-back">‚Üê Back to Search</a>
    </div>
    {% endif %}

    <!-- Header Table for foolproof centering -->
    <table style="width: 100%; margin-bottom: 20px;">
        <tr>
            <td style="text-align: center; border: none; padding: 0;">
                <div style="font-size: 24pt; font-weight: bold; margin-bottom: 10px; color: #000;">Barisal Polytechnic
                    Institute</div>
                <div style="font-size: 16pt; font-weight: bold; color: #000;">Exam Seat Plan - {{ room.name }}</div>
                <div style="font-size: 12pt; margin-top: 10px; color: #000;">Total Allocated: {{ room.seats.count }}
                </div>
            </td>
        </tr>
    </table>

    <div class="table-wrapper">
        <table class="grid-container">
            {% for row in grid %}
            <tr>
                <td class="row-label">{{ forloop.counter }}</td>
                {% for seat in row %}
                {% if seat %}
                <td class="seat {% if seat.allocation %}seat-assigned{% else %}seat-empty{% endif %}">
                    <div class="seat-content">
                        {% if seat.allocation %}
                        <span class="student-roll">{{ seat.allocation.student.roll_number }}</span>
                        <span class="student-class">{{ seat.allocation.student.department.code }} -
                            {{ seat.allocation.student.semester.number }}</span>
                        {% else %}
                        Empty
                        {% endif %}
                    </div>
                </td>
                {% else %}
                <td style="border: none;"></td> <!-- Gap -->
                {% endif %}
                {% endfor %}
            </tr>
            {% endfor %}
        </table>
    </div>

    <div id="footerContent">
        Generated by Exam Seat Plan System
    </div>
</body>

</html>